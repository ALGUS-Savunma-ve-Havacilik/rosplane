<!--This launch file controls the plane to be level. -->
<launch>

<arg name="mav_name"  default="MTD"/>
 <rosparam command="load" file="$(find rosplane)/param/MTD.yaml" ns="controller"/>

 <node name="naze"  pkg="rosflight"  type="rosflight_io" output="screen">
        <param name="port" value="/dev/naze"/>
 </node>

 <node name="gps_driver" pkg="rosflight_utils" type="gps">
 <param name="port" value="/dev/m8"/>
 <param name="baud" value="115200"/>
 </node>

 <node name="estimator" pkg="rosplane" type="rosplane_estimator" output="screen"/>
<!--<node name="static_command_pub" pkg="rostopic" type="rostopic"
    args="pub -r 10 controller_commands rosplane_msgs/Controller_Commands
   '{Va_c: 0.1,
    h_c: 0.0,
    chi_c: 0.0,
    phi_ff: 0,
    aux: [0.0, 0.0, 0.0, 0.0],
    aux_valid: 0}'"/>
-->
<!-- <node name="servo_command_pub" pkg="rostopic" type="rostopic"
       args="pub -r 10 /command rosflight_msgs/Command
       '{
         F: 0.1}'"/>
-->

<node name="controller" pkg="rosplane" type="rosplane_controller" output="screen">
    <param name="PWM_RAD_E" value="2.8"/>
	<param name="PWM_RAD_A" value="-1.6"/>
	<param name="PWM_RAD_R" value="1.8"/>
    <param name="ALT_TOZ" value="20"/>
    <param name="ALT_HZ" value="10"/>
    <param name="MAX_T" value="1.0"/>
 </node>
 <node pkg="rosservice" type="rosservice" name="calibration_of_imu" args="call --wait /calibrate_imu"/>
 <node pkg="rosservice" type="rosservice" name="calibration_of_baro" args="call --wait /calibrate_baro"/>
 <node pkg="rosservice" type="rosservice" name="calibration_of_airspeed" args="call --wait /calibrate_airspeed"/>
</launch>
